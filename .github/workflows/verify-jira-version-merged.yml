name: Verify JIRA Version Merged

on:
  workflow_dispatch:
    inputs:
      target_branch:
        description: 'Target branch to check'
        required: true
        default: '3.33'
      base_branch:
        description: 'Base branch for comparison (optional)'
        required: false
        default: 'main'
      tickets_list:
        description: 'Comma-separated list of tickets (e.g. ED-21219, ED-20358)'
        required: true

jobs:
  verify:
    name: Verify JIRA Tickets Merged
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout source code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Install Node.js 20.x
        uses: actions/setup-node@v4
        with:
          node-version: 20.x

      - name: Verify tickets merged
        env:
          TICKETS_LIST: ${{ github.event.inputs.tickets_list }}
          TARGET_BRANCH: ${{ github.event.inputs.target_branch }}
          BASE_BRANCH: ${{ github.event.inputs.base_branch }}
        run: node .github/scripts/verify-jira-version-merged.js

      - name: Job summary
        if: always()
        run: |
          echo "## Verification Results" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Configuration" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Branch to check:** ${{ github.event.inputs.target_branch }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Tickets Searched For" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "${{ github.event.inputs.tickets_list }}" >> $GITHUB_STEP_SUMMARY
